function editar(a) { window.location.href = homePage + "Admin/Concurso/Cadastro_Empresa/" + a } function editarAtivacao(a, o) { $.blockUI({ message: mensagemDesativando, css: cssCarregando }); var e = homePage + "Admin/Concurso/EditarAtivacaoEmpresao"; $.ajax({ type: "POST", url: e, data: { id: o }, success: function (o) { o.Sucesso ? (a.removeClass("checked"), a.removeClass("unchecked"), a.addClass(o.Ativo ? "checked" : "unchecked"), alert(operacaoMensagemSucesso)) : alert(operacaoMensagemErro), $.unblockUI() }, error: function (a, o, e) { alertaErroJS({ NomeFuncao: "editarAtivacao()", ResponseText: a.responseText }), $.unblockUI() } }) } function iniciarTelaListaEmpresas() { listarEmpresas() } function iniciarTelaCadastroEmpresa() { $(".userForm").on("init.field.bv", function (a, o) { removerIconeValidator(a, o) }).bootstrapValidator({ container: "tooltip", feedbackIcons: { valid: "glyphicon glyphicon-ok", invalid: "glyphicon glyphicon-remove", validating: "glyphicon glyphicon-refresh" }, fields: { RazaoSocial: { validators: { notEmpty: { message: razaoSocialObrigatorio } } }, Nome: { validators: { notEmpty: { message: nomeObrigatorio } } }, cnpj: { validators: { notEmpty: { message: cnpjObrigatorio } } }, banco: { validators: { notEmpty: { message: bancoObrigatorio } } }, Agencia: { validators: { notEmpty: { message: agenciaObrigatorio } } }, ContaCorrente: { validators: { notEmpty: { message: contaObrigatorio } } }, Convenio: { validators: { notEmpty: { message: convenioObrigatorio } } } } }).on("success.form.bv", function (a) { return a.preventDefault(), salvar(), !1 }), "0" == $(".cadastro-empresa").find("#Convenio").val() && $(".cadastro-empresa").find("#Convenio").val(""), $(".cadastro-empresa").find("#txtCNPJ").mask("00.000.000/0000-00"), $(".cadastro-empresa").find("#Convenio").mask("0######"), $(".cadastro-empresa").find("#Agencia").mask("0###"), $(".cadastro-empresa").find("#ContaCorrente").mask("0#######"), $("#Id").val() <= 0 ? ($("#chkAtivo").prop("checked", !0), $("#chkAtivo").attr("disabled", !0)) : $("#ddlBanco").val(bancoSelecionado) } function listarEmpresas() { $.blockUI({ message: mensagemCarregando, css: cssCarregando }); var a = homePage + "Admin/Concurso/ListarEmpresas"; $.ajax({ type: "POST", url: a, success: function (a) { $(".lista").html(""), $(".lista").append(a), montarTabela(), $(".lista").find("table").attr("summary") == naoEncontrado && $(".lista").css("marginTop", 0), $(".editarAtivacao").on("click", function () { editarAtivacao($(this), $(this).closest("tr").find("td:first span").html()) }), $(".editar").on("click", function () { editar($(this).closest("tr").find("td:first span").html()) }), $.unblockUI() }, error: function (a, o, e) { alertaErroJS({ NomeFuncao: "listarEmpresas()", ResponseText: a.responseText }), $.unblockUI() } }) } function montarTabela() { oTable = $("#tblEmpresas").dataTable({ bLengthChange: !1, order: [[1, "asc"]], aoColumnDefs: [{ bSortable: !1, aTargets: [0, 3, 4, 5, 6] }], language: { url: urlDataTable } }), $("#tblEmpresas_filter").parent().removeClass("col-sm-6").addClass("col-sm-10"), $("#tblEmpresas_filter input").focus() } function salvar() { var a = $("#Id").val() <= 0 ? 0 : $("#Id").val(), o = $("#Nome").val(), e = $("#RazaoSocial").val(), s = removerTodosCaracteresMenosNumeros($("#txtCNPJ").val()), r = $("#ddlBanco").val(), n = removerTodosCaracteresMenosNumeros($("#Convenio").val()), t = removerTodosCaracteresMenosNumeros($("#Agencia").val()), i = removerTodosCaracteresMenosNumeros($("#ContaCorrente").val()), c = $("#chkAtivo").is(":checked"); $.blockUI({ message: mensagemSalvando, css: cssCarregando }); var l = homePage + "Admin/Concurso/Salvar_Empresa"; $.ajax({ type: "POST", url: l, data: { id: a, nome: o, razaoSocial: e, cnpj: s, banco: r, convenio: n, agencia: t, conta: i, ativo: c }, success: function (a) { alert(a.Mensagem), a.Sucesso && (window.location.href = homePage + "Admin/Concurso/Index_Empresa"), $.unblockUI() }, error: function (a, o, e) { alertaErroJS({ NomeFuncao: "salvar()", ResponseText: a.responseText }), $.unblockUI() } }) } var oTable;